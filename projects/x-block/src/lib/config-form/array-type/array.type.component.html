<!--
 * @Author         : Shang
 * @Date           : 2024-06-11
 * @LastEditors    : Shang
 * @LastEditTime   : 2025-05-08
 * @Description    :  
 * Copyright (c) 2025 by Crepri, All Rights Reserved. 
-->
<div class="mb-3" [style.display]="field.templateOptions?.['display']">
  <div class="form-field-label" (click)="toggleExpandAction()">
    <div *ngIf="to.label">{{ to.label }}</div>
    <div class="form-field-label-right">
      <span class="count-number">共{{ field.fieldGroup!.length }}条</span>
      <x-icon
        [xType]="isExpand ? 'keyboard_arrow_up' : 'keyboard_arrow_down'"
        xSize="14px"
        xColor="#000"
      ></x-icon>
    </div>
  </div>
  <div *ngIf="isExpand" [@toggleExpand]="isExpand ? 'expand' : 'fold'">
    <div
      class="formly formly-validation-danger"
      role="alert"
      *ngIf="showError && formControl.errors"
    >
      <formly-validation-message [field]="field"></formly-validation-message>
    </div>

    <div class="rows">
      <div *ngFor="let fieldItem of field.fieldGroup; let i = index" class="row">
        <div class="item" style="position: relative">
          <formly-field
            style="z-index: 1"
            class="col-10 formly-field-array-item"
            [field]="fieldItem"
          ></formly-field>
          <app-delete-widget class="delete-btn" (click)="remove(i)"></app-delete-widget>
          <div style="position: absolute; right: 30px; top: 12px; z-index: 1">
            {{ to.label }}序号:{{ i + 1 }}
          </div>
        </div>
      </div>
      <div *ngIf="field.fieldGroup!.length === 0" class="empty-data">暂无数据</div>
      <div (click)="add()" class="add-array-btn">
        +
        <div class="add-array-tip">添加一项</div>
      </div>
    </div>
  </div>
  <div *ngIf="!isExpand" [@toggleExpand]="isExpand ? 'expand' : 'fold'"></div>
</div>
